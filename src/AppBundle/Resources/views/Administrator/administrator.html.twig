{% extends "AppBundle:Layouts:layoutprofiles.html.twig"%}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('assets/js/d3.js') }}"></script>
    <script src="{{ asset('assets/js/custom/grafica.js') }}"></script>
{% endblock %}

{% block content %}
    <section class="adminstrator-section">

        <div class="container">
            <div class="row">
                <div class="col-lg-3">
                    <h2 class="page-header">Opciones</h2>
                    <ul class="list-group">
                        <a href="{{ path('administrator_index') }}" class="list-group-item list-group-item-info"><i class="fa fa-check-circle" aria-hidden="true"></i>Empresas sin validar {% for empresas in empresas %} <span class="badge">{{empresas}}</span>{% endfor %}</a>
                        <a href="{{ path('administrator_comment') }}" class="list-group-item list-group-item-info"><i class="fa fa-comments" aria-hidden="true"></i>Comentarios sin validar {% for comentarios in comentarios %} <span class="badge">{{comentarios}}</span>{% endfor %}</a>
                        <a href="{{ path('administrator_claim') }}" class="list-group-item list-group-item-warning"><i class="fa fa-gavel" aria-hidden="true"></i>Reclamaciones {% for claims in claims %} <span class="badge">{{claims}}</span>{% endfor %}</a>
                        <a href="{{ path('administrator_user') }}" class="list-group-item list-group-item-danger"><i class="fa fa-address-book" aria-hidden="true"></i>Administrar usuarios {% for usuarios in usuarios %} <span class="badge">{{usuarios}}</span>{% endfor %}</a>
                        <a href="{{ path('administrator_allcompanies') }}" class="list-group-item list-group-item-danger"><i class="fa fa-building" aria-hidden="true"></i>Administrar empresas {% for todas_empresas in todas_empresas %} <span class="badge">{{todas_empresas}}</span>{% endfor %}</a>
                    </ul>
                </div>
                <div class="col-lg-9">
                    <h2 class="page-header">Empresas pendientes por validar</h2>
                    <div class="table-responsive">
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nombre</th>
                                    <th>RFC</th>
                                    <th>Sector</th>
                                    <th>Representante</th>
                                    <th>Ext. Representante</th>
                                    <th>Email de Representante</th>
                                    <th>Acci√≥n</th>
                                </tr>
                            </thead>


                            {# usamos la variable company para recorrer cada resultado y mostrarlos #}
                            {% for company in pagination  %}
                                <tbody>
                                    <tr>
                                        <td>{{ company.id }}</td>
                                        <td>{{ company.tradename }}</td>
                                        <td>{{ company.rfc }}</td>
                                        <td>{{ company.businesssector }}</td>
                                        <td>{{ company.contacname }}</td>
                                        <td>{{ company.telephoneext }}</td>
                                        <td>{{ company.businessemail }}</td>
                                        <td><a href="{{path('administrator_validate_company', {'id':company.id})}}" type="button" class="btn btn-success btn-xs" data-toggle="tooltip" data-placement="left" title="Validar" data-original-title=""><i class="fa fa-check" aria-hidden="true"></i></a></td>
                                    </tr>
                                </tbody>
                            {% endfor %}
                        </table>
                    </div>
                </div>                
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <h2 class="page-header">Empresas destacadas</h2>
                </div>
                <div class="col-lg-12">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Opiniones Totales</th>
                                <th>Puntos Totales</th>
                                <th>Calificacion Generals</th>
                            </tr>
                        </thead>

                        {% for avg in general_avg %}
                            {% for company in pagination %}
                                <tbody>
                                    <tr>
                                        {% if company.id == avg.company%}
                                            <td>{{ company.id }}</td>
                                            <td>{{ company.tradename }}</td>
                                            <td>0</td>
                                            <td>{{ avg.promedio }}</td>
                                        {% endif %}
                                    </tr>
                                </tbody>



                            {% endfor %}
                        {% endfor %}


                    </table>
                </div>
            </div>


            <div class="row">
                <div class="col-lg-12" >
                    <button onload="graficar()">Graficar</button>
                    <div class="rellenar"></div>
                </div>
            </div>
        </div>
    </section>
{%endblock%}