{% extends "AppBundle:Layouts:layout.html.twig"%}
{% block javascripts %}
    {{parent()}}
    <script src="{{ asset('assets/js/custom/profile.js') }}"></script>
{% endblock javascripts %}
{% block content %}
    {# con esto obtenemos el del usuario app.user.name #}
    <div class="col-lg-10 box-default profile-box">
        <div class="avatar">
            {% if company.logo == null%}
                <img src="{{ asset('assets/images/company-logo.png') }}"/>
                
            {% else %}
                <img src="{{ asset('uploads/users/'~company.logo) }}"/>
            {% endif %}
        </div>
        
        <div class="company-name">
            <h2>{{ company.tradename }} | {{ company.businesssector}}</h2>
            <p>{{ company.description }}</p>
        </div>
        
        <div id="company-stats">
            
            {#set user_stats = app.user|user_stats#}
            
            <div class="following-data">
                <a href="#">
                    <span class="label-stat">Seguidores</span>
                    <span class="number-stat">0</span>
                </a>
            </div>
            <div class="following-data">
                <a href="#">
                    <span class="label-stat">Opiniones</span>
                    <span class="number-stat">0</span>
                </a>
            </div>
            
            <div class="following-data">
                <a href="#">
                    <span class="label-stat">Me gusta</span>
                    <span class="number-stat">0</span>
                </a>
            </div>
            <div class="clearfix"></div>
        </div>
            
        <div class="manager-name">
            <h4>Encargado: </h4>
            <p>Nombre: {{ company.contacname }}</p>
            <p>Cargo: {{ company.position }}</p>
            <p>Contacto: {{ company.businessemail }}</p>
        </div>
        
       
        
        {% for opinions in pagination %}
            <div class="opinion-item">
                <div class="media-left ">
                    <a href="#">
                        <div class="avatar">
                            {% if opinions.user.image == null%}
                                <img src="{{ asset('assets/images/default.jpg') }}"/>
                            {% else %}
                                <img src="{{ asset('uploads/users/'~opinions.user.image) }}"/>
                            {% endif %}
                        </div>
                    </a>
                </div>

                <div class="media-body">
                    <h5 class="media-heading"><a href="#">{{opinions.user.name}} {{opinions.user.plastname}}</a>
                        {% if(opinions.user.id is defined) and (opinions.user.id == app.user.id) %}
                            <div class="btn-group pull-right">
                                <button class="btn btn-link btn-xs dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <span class="caret"></span>
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a class="btn-delete-pub" data-id="{{ opinions.id }}">Eliminar</a></li>

                                </ul>
                            </div>
                        {% endif %}

                        <span class="pull-right">{{opinions.createdAt|long_time}}</span>

                    </h5>
                    <p>{{opinions.generalcomment}}</p>


                    {#  
                        Esta condicion es para cuando en los comentarios publiquen imagenes o documentos
                        Falta agregar a la base de datos el campo document y images.
                        Necesitamos agregar igual la condicion para la imagen 
                    #}

                    {#{% if(opinions.document is defined ) and (opinions.document != null) %}
                        <a href="{{ asset('assets/opinions/documment'~opinions.document)}}" class="btn-doc glyphicon glyphicon-save" aria-hidden="true" target="_blank"></a>
                    {% endif %}#}

                    <div class="like">
                        <span data-id="{{opinions.id}}" class="
                              {% if app.user|liked(opinions) == true%}
                                          hidden
                              {% endif %}
                                      btn-like glyphicon glyphicon-heart" 
                              aria-hidden="true" 
                              data-toggle="tooltip" 
                              data-placement="left" 
                              title="Me gusta">
                        </span>

                        <span data-id="{{opinions.id}}" class="
                              {% if app.user|liked(opinions) == false%}
                                          hidden
                              {% endif %}
                                      btn-unlike active glyphicon glyphicon-heart" 
                              aria-hidden="true" 
                              data-toggle="tooltip" 
                              data-placement="left" 
                              title="Ya no me gusta">
                        </span>
                    </div>

                </div>
                <hr />
            </div>

        {% endfor %}

        <div class="pagination">
            {{ knp_pagination_render(pagination) }}
        </div>
    </div>
{% endblock %}
